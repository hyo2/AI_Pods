# ğŸ“– Phase 3-4 í†µí•© ê°€ì´ë“œ
**Alan Document Lab - NotebookLM í´ë¡  ì´ë¯¸ì§€ ìƒì„± íŒŒì´í”„ë¼ì¸**

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ì „ì²´ ì•„í‚¤í…ì²˜](#ì „ì²´-ì•„í‚¤í…ì²˜)
3. [Phase íë¦„ë„](#phase-íë¦„ë„)
4. [ì œê³µ íŒŒì¼](#ì œê³µ-íŒŒì¼)
5. [ì„¤ì¹˜ ë° ì„¤ì •](#ì„¤ì¹˜-ë°-ì„¤ì •)
6. [í†µí•© ê°€ì´ë“œ](#í†µí•©-ê°€ì´ë“œ)
7. [í…ŒìŠ¤íŠ¸ ë°©ë²•](#í…ŒìŠ¤íŠ¸-ë°©ë²•)
8. [ì£¼ìš” ê°œì„ ì‚¬í•­](#ì£¼ìš”-ê°œì„ ì‚¬í•­)
9. [API ë ˆí¼ëŸ°ìŠ¤](#api-ë ˆí¼ëŸ°ìŠ¤)
10. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ğŸ¯ ê°œìš”

### **ëª©ì **
íƒ€ì„ìŠ¤íƒ¬í”„ê°€ í¬í•¨ëœ íŒŸìºìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì…ë ¥ë°›ì•„, NotebookLM ìŠ¤íƒ€ì¼ì˜ ì‹œê°í™” ì´ë¯¸ì§€ë¥¼ ìë™ ìƒì„±í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤.

### **ì£¼ìš” íŠ¹ì§•**
- âœ… **ë™ì  ì´ë¯¸ì§€ ê°œìˆ˜**: íŒŸìºìŠ¤íŠ¸ ê¸¸ì´ì— ë”°ë¼ 3-25ê°œ ìë™ ê²°ì •
- âœ… **ìŠ¤íƒ€ì¼ í†µì¼**: ëª¨ë“  ì´ë¯¸ì§€ê°€ ê°™ì€ ì‹œë¦¬ì¦ˆì²˜ëŸ¼ ë³´ì´ë„ë¡ ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼ ì ìš©
- âœ… **ë‚˜ë…¸ë°”ë‚˜ë‚˜ ìµœì í™”**: Gemini 2.5 Flash Image (ë‚˜ë…¸ë°”ë‚˜ë‚˜) ì „ìš© í”„ë¡¬í”„íŠ¸
- âœ… **í•œê¸€ í”„ë¡¬í”„íŠ¸**: ìì—°ìŠ¤ëŸ¬ìš´ í•œê¸€ ëŒ€í™”í˜• í”„ë¡¬í”„íŠ¸ ("~í•´ì£¼ì„¸ìš”")
- âœ… **ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ëŠ” ì˜ì–´**: ë‹¤ì´ì–´ê·¸ë¨/ì°¨íŠ¸ ë¼ë²¨ì€ ì˜ì–´ë¡œ ë Œë”ë§ (í•œê¸€ ê¹¨ì§ ë°©ì§€)
- âœ… **ì¬ì‹œë„ ë¡œì§**: ìµœëŒ€ 3íšŒ ì¬ì‹œë„ë¡œ ì•ˆì •ì„± í–¥ìƒ
- âœ… **ë”ë¯¸ ë°ì´í„° ì—†ìŒ**: ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ì—ëŸ¬ ë°œìƒ (ì‹¤ì œ ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ)

### **ê¸°ìˆ  ìŠ¤íƒ**
- **LLM**: Gemini 2.5 Flash (ë©”íƒ€ë°ì´í„°, ì´ë¯¸ì§€ ê³„íš, í”„ë¡¬í”„íŠ¸ ìƒì„±)
- **ì´ë¯¸ì§€ ìƒì„±**: Gemini 2.5 Flash Image (ë‚˜ë…¸ë°”ë‚˜ë‚˜)
- **í”„ë ˆì„ì›Œí¬**: Google Cloud Vertex AI
- **ì–¸ì–´**: Python 3.10+

---

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì…ë ¥: podcast_script.txt                  â”‚
â”‚              (íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨ ìŠ¤í¬ë¦½íŠ¸, 28ê°œ ì¥ë©´)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Phase 3: ì´ë¯¸ì§€ íŒŒì´í”„ë¼ì¸                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  [Phase 3-0] ë©”íƒ€ë°ì´í„° ì¶”ì¶œ                                  â”‚
â”‚    â”œâ”€ GlobalVisualGuidelines (ìŠ¤íƒ€ì¼ í†µì¼)                   â”‚
â”‚    â””â”€ ContentAnalysis (ì±•í„°, í•µì‹¬ ê°œë…)                      â”‚
â”‚         â†“                                                     â”‚
â”‚  [Phase 3-1] ì´ë¯¸ì§€ ê³„íš ìƒì„±                                 â”‚
â”‚    â””â”€ 7ê°œ ì´ë¯¸ì§€ ê³„íš (ë™ì  ê°œìˆ˜)                             â”‚
â”‚         â†“                                                     â”‚
â”‚  [Phase 3-2] í”„ë¡¬í”„íŠ¸ ìƒì„±                                    â”‚
â”‚    â””â”€ 7ê°œ í•œê¸€ í”„ë¡¬í”„íŠ¸ (ìŠ¤íƒ€ì¼ í†µì¼, ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ëŠ” ì˜ì–´) â”‚
â”‚         â†“                                                     â”‚
â”‚  [Phase 3-3] íƒ€ì„ë¼ì¸ ìƒì„±                                    â”‚
â”‚    â””â”€ íƒ€ì„ìŠ¤íƒ¬í”„ ë§¤í•‘                                         â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Phase 4: ì´ë¯¸ì§€ ìƒì„±                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  [Phase 4] ë‚˜ë…¸ë°”ë‚˜ë‚˜ ì´ë¯¸ì§€ ìƒì„±                             â”‚
â”‚    â””â”€ 7ê°œ PNG ì´ë¯¸ì§€ (16:9, 1024x576)                        â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì¶œë ¥: outputs/ ë””ë ‰í† ë¦¬                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  metadata/podcast_metadata.json                              â”‚
â”‚  image_plans/image_plans.json                                â”‚
â”‚  image_prompts/image_prompts.json                            â”‚
â”‚  timeline/timeline.json                                      â”‚
â”‚  images/img_001.png ~ img_007.png                            â”‚
â”‚  images/manifest.json                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Phase íë¦„ë„

### **Phase 3-0: ë©”íƒ€ë°ì´í„° ì¶”ì¶œ**
```
ìŠ¤í¬ë¦½íŠ¸ (28ê°œ ì¥ë©´)
  â†“
[Gemini 2.5 Flash]
  â†“
1ï¸âƒ£ GlobalVisualGuidelines
   - art_style: "Flat vector illustration"
   - color_palette: {primary, secondary, accent, ...}
   - lighting_style: "ë°ê³  ê· ì¼í•œ ì¡°ëª…"
   - composition_guidelines: "16:9 ë¹„ìœ¨, ì¤‘ì•™ ì§‘ì¤‘"
   
2ï¸âƒ£ ContentAnalysis
   - main_topic: "AI ìë™ íŒŸìºìŠ¤íŠ¸ ìƒì„±"
   - summary: "í•œ ì¤„ ìš”ì•½"
   - detailed_summary: "3-10ë¬¸ì¥ ìƒì„¸ ìš”ì•½"
   - chapters: [5-8ê°œ ì±•í„°]
   - key_concepts: [ì‹œê°í™”í•  í•µì‹¬ ìš©ì–´]
   - critical_moments: [ì¤‘ìš” ìˆœê°„]
```

### **Phase 3-1: ì´ë¯¸ì§€ ê³„íš ìƒì„±**
```
ë©”íƒ€ë°ì´í„° + ì „ì²´ ìŠ¤í¬ë¦½íŠ¸
  â†“
[Gemini 2.5 Flash]
  â†“
7ê°œ ImagePlan
  - image_id: "img_001"
  - title: "ì •ë³´ ê³¼ë¶€í•˜ì™€ ì½ê¸° í”¼ë¡œ"
  - visual_concept: "í”¼ê³¤í•œ ì‚¬ëŒ + ìˆ˜ë§ì€ ë¬¸ì„œ"
  - primary_timestamp: "00:00:48"
  - duration: 25ì´ˆ
```

### **Phase 3-2: í”„ë¡¬í”„íŠ¸ ìƒì„±**
```
ImagePlan + GlobalVisualGuidelines
  â†“
[Gemini 2.5 Flash]
  â†“
7ê°œ í”„ë¡¬í”„íŠ¸
  - style: "Flat vector illustration"
  - image_prompt: "í˜„ëŒ€ ì‚¬íšŒì˜ ì •ë³´ ê³¼ë¶€í•˜ë¡œ ì§€ì³ 
                   ì±…ìƒì— ì•‰ì•„ ì›¹ ì•„í‹°í´, PDF, ë¦¬í¬íŠ¸ 
                   ì•„ì´ì½˜ ë“± ìˆ˜ë§ì€ ë¬¸ì„œì— ë‘˜ëŸ¬ì‹¸ì—¬ 
                   í”¼ê³¤í•´ ë³´ì´ëŠ” ì‚¬ëŒì„ ê·¸ë ¤ì£¼ì„¸ìš”. 
                   **ëª¨ë“  ë¼ë²¨ê³¼ í…ìŠ¤íŠ¸ëŠ” ì˜ì–´ë¡œ í‘œê¸°**
                   í•´ì£¼ì„¸ìš”. Flat vector illustration 
                   ìŠ¤íƒ€ì¼ë¡œ..."
  - visual_elements: [...]
  - composition: "..."
  - lighting: "..."
  - color_usage: "..."
```

### **Phase 3-3: íƒ€ì„ë¼ì¸ ìƒì„±**
```
ì´ë¯¸ì§€ ê³„íš â†’ íƒ€ì„ë¼ì¸ ë§¤í•‘
  â†“
timeline.json
  - 00:00:48 ~ 00:01:13: img_001 (25ì´ˆ)
  - 00:01:19 ~ 00:01:39: img_002 (20ì´ˆ)
  - ...
```

### **Phase 4: ì´ë¯¸ì§€ ìƒì„±**
```
í”„ë¡¬í”„íŠ¸
  â†“
[Gemini 2.5 Flash Image (ë‚˜ë…¸ë°”ë‚˜ë‚˜)]
  â†“
img_001.png ~ img_007.png
  - í•´ìƒë„: 1024x576 (16:9)
  - í˜•ì‹: PNG
  - ìŠ¤íƒ€ì¼: í†µì¼ë¨
  - ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸: ì˜ì–´
```

---

## ğŸ“¦ ì œê³µ íŒŒì¼

### **ğŸ”§ ë…¸ë“œ íŒŒì¼ (6ê°œ)**

#### **1. script_parser_node.py**
- **ì—­í• **: íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨ ìŠ¤í¬ë¦½íŠ¸ íŒŒì‹±
- **ì…ë ¥**: `podcast_script.txt`
- **ì¶œë ¥**: `List[PodcastScene]` (28ê°œ ì¥ë©´)

#### **2. metadata_extraction_node.py** â­
- **ì—­í• **: ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
- **ì…ë ¥**: `List[PodcastScene]`
- **ì¶œë ¥**: `PodcastMetadata`
  - `GlobalVisualGuidelines` (ìŠ¤íƒ€ì¼ í†µì¼)
  - `ContentAnalysis` (ì£¼ì œ, ìš”ì•½, ì±•í„°, í•µì‹¬ ê°œë…)
- **íŠ¹ì§•**:
  - ì¬ì‹œë„ 3íšŒ
  - JSON ì‘ë‹µ ê°•ì œ
  - ë”ë¯¸ ë°ì´í„° ì—†ìŒ
  - ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ ì˜ì–´ ê°€ì´ë“œ

#### **3. image_planning_node.py** â­
- **ì—­í• **: ì´ë¯¸ì§€ ê³„íš ìƒì„± (ë™ì  ê°œìˆ˜)
- **ì…ë ¥**: ì „ì²´ ìŠ¤í¬ë¦½íŠ¸ + ë©”íƒ€ë°ì´í„°
- **ì¶œë ¥**: `List[ImagePlan]` (3-25ê°œ, ìë™ ê²°ì •)
- **íŠ¹ì§•**:
  - íŒŸìºìŠ¤íŠ¸ ê¸¸ì´ì— ë”°ë¼ ì´ë¯¸ì§€ ê°œìˆ˜ ìë™ ê²°ì •
  - ì¬ì‹œë„ 3íšŒ
  - ë”ë¯¸ ë°ì´í„° ì—†ìŒ

#### **4. prompt_generation_node.py** â­
- **ì—­í• **: ë‚˜ë…¸ë°”ë‚˜ë‚˜ í”„ë¡¬í”„íŠ¸ ìƒì„±
- **ì…ë ¥**: `ImagePlan` + `GlobalVisualGuidelines`
- **ì¶œë ¥**: í•œê¸€ í”„ë¡¬í”„íŠ¸ (200-300ì)
- **íŠ¹ì§•**:
  - ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼ í†µì¼
  - í•œê¸€ ëŒ€í™”í˜• í”„ë¡¬í”„íŠ¸
  - **ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ëŠ” ì˜ì–´ë¡œ ëª…ì‹œ**
  - ì¬ì‹œë„ 3íšŒ
  - ë”ë¯¸ ë°ì´í„° ì—†ìŒ

#### **5. timestamp_mapper.py**
- **ì—­í• **: íƒ€ì„ë¼ì¸ ìƒì„±
- **ì…ë ¥**: `List[ImagePlan]`
- **ì¶œë ¥**: `timeline.json`

#### **6. image_generation_node.py** â­
- **ì—­í• **: ë‚˜ë…¸ë°”ë‚˜ë‚˜ ì´ë¯¸ì§€ ìƒì„±
- **ì…ë ¥**: í”„ë¡¬í”„íŠ¸ JSON
- **ì¶œë ¥**: PNG ì´ë¯¸ì§€ íŒŒì¼ë“¤
- **íŠ¹ì§•**:
  - Gemini 2.5 Flash Image ì‚¬ìš©
  - 16:9 ë¹„ìœ¨ (1024x576)
  - 429 ì—ëŸ¬ ìë™ ì¬ì‹œë„ (ì§€ìˆ˜ ë°±ì˜¤í”„)
  - ë¹„ìš©: ì´ë¯¸ì§€ë‹¹ $0.039

---

### **ğŸ§ª í…ŒìŠ¤íŠ¸ íŒŒì¼ (2ê°œ)**

#### **1. test_new_pipeline.py**
- **ì—­í• **: Phase 3 í†µí•© í…ŒìŠ¤íŠ¸ (ë©”íƒ€ë°ì´í„° â†’ íƒ€ì„ë¼ì¸)
- **ì‹¤í–‰**: `python tests/test_new_pipeline.py`
- **ì¶œë ¥**:
  - `outputs/metadata/podcast_metadata.json`
  - `outputs/image_plans/image_plans.json`
  - `outputs/image_prompts/image_prompts.json`
  - `outputs/timeline/timeline.json`

#### **2. test_image_generation.py**
- **ì—­í• **: Phase 4 ì´ë¯¸ì§€ ìƒì„± í…ŒìŠ¤íŠ¸
- **ì‹¤í–‰**: `python tests/test_image_generation.py`
- **ì¶œë ¥**:
  - `outputs/images/img_001.png ~ img_007.png`
  - `outputs/images/manifest.json`

---

## âš™ï¸ ì„¤ì¹˜ ë° ì„¤ì •

### **1. í™˜ê²½ ë³€ìˆ˜**

`.env` íŒŒì¼ ìƒì„±:
```bash
# Google Cloud ì„¤ì •
GOOGLE_CLOUD_PROJECT=your-project-id
GOOGLE_APPLICATION_CREDENTIALS=path/to/service-account-key.json

# Vertex AI ì„¤ì • (ì„ íƒ)
VERTEXAI_LOCATION=us-central1
```

### **2. í•„ìˆ˜ íŒ¨í‚¤ì§€**

```bash
pip install google-cloud-aiplatform python-dotenv Pillow
```

### **3. Google Cloud ì¸ì¦**

**ë°©ë²• 1: Service Account Key**
```bash
export GOOGLE_APPLICATION_CREDENTIALS="path/to/key.json"
```

**ë°©ë²• 2: gcloud CLI**
```bash
gcloud auth application-default login
```

---

## ğŸ”¨ í†µí•© ê°€ì´ë“œ

### **Step 1: íŒŒì¼ ë³µì‚¬**

```bash
# ë…¸ë“œ íŒŒì¼ ë³µì‚¬
cp outputs/script_parser_node.py app/nodes/
cp outputs/metadata_extraction_node.py app/nodes/
cp outputs/image_planning_node.py app/nodes/
cp outputs/prompt_generation_node.py app/nodes/
cp outputs/timestamp_mapper.py app/nodes/
cp outputs/image_generation_node.py app/nodes/

# í…ŒìŠ¤íŠ¸ íŒŒì¼ ë³µì‚¬
cp outputs/test_new_pipeline.py tests/
cp outputs/test_image_generation.py tests/
```

### **Step 2: ë””ë ‰í† ë¦¬ êµ¬ì¡° í™•ì¸**

```
alan-document-lab/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ nodes/
â”‚       â”œâ”€â”€ script_parser_node.py
â”‚       â”œâ”€â”€ metadata_extraction_node.py       â­ ìƒˆë¡œ ì¶”ê°€
â”‚       â”œâ”€â”€ image_planning_node.py            â­ ìƒˆë¡œ ì¶”ê°€
â”‚       â”œâ”€â”€ prompt_generation_node.py         â­ ìƒˆë¡œ ì¶”ê°€
â”‚       â”œâ”€â”€ timestamp_mapper.py               â­ ìƒˆë¡œ ì¶”ê°€
â”‚       â””â”€â”€ image_generation_node.py          â­ ìƒˆë¡œ ì¶”ê°€
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_new_pipeline.py                  â­ ìƒˆë¡œ ì¶”ê°€
â”‚   â””â”€â”€ test_image_generation.py              â­ ìƒˆë¡œ ì¶”ê°€
â”œâ”€â”€ data/
â”‚   â””â”€â”€ podcast_script.txt                    (ì…ë ¥ íŒŒì¼)
â””â”€â”€ outputs/                                   (ìë™ ìƒì„±)
    â”œâ”€â”€ metadata/
    â”œâ”€â”€ image_plans/
    â”œâ”€â”€ image_prompts/
    â”œâ”€â”€ timeline/
    â””â”€â”€ images/
```

### **Step 3: ì…ë ¥ íŒŒì¼ ì¤€ë¹„**

`data/podcast_script.txt`:
```
[00:00:00] Host A: ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€...
[00:00:12] Host B: ë°˜ê°‘ìŠµë‹ˆë‹¤...
...
```

### **Step 4: í…ŒìŠ¤íŠ¸ ì‹¤í–‰**

```bash
# Phase 3 í…ŒìŠ¤íŠ¸ (ë©”íƒ€ë°ì´í„° â†’ í”„ë¡¬í”„íŠ¸)
python tests/test_new_pipeline.py

# Phase 4 í…ŒìŠ¤íŠ¸ (ì´ë¯¸ì§€ ìƒì„±)
python tests/test_image_generation.py
```

### **Step 5: ê²°ê³¼ í™•ì¸**

```bash
# ìƒì„±ëœ íŒŒì¼ í™•ì¸
ls -lh outputs/metadata/
ls -lh outputs/image_plans/
ls -lh outputs/image_prompts/
ls -lh outputs/timeline/
ls -lh outputs/images/
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### **Phase 3 í…ŒìŠ¤íŠ¸**

```bash
python tests/test_new_pipeline.py
```

**ì˜ˆìƒ ì¶œë ¥:**
```
================================================================================
ğŸš€ Phase 3 í†µí•© í…ŒìŠ¤íŠ¸ (ìƒˆë¡œìš´ ì„¤ê³„)
================================================================================

ì˜µì…˜:
1. ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
2. ê²°ê³¼ ë¶„ì„

ì„ íƒ (1, 2, ê¸°ë³¸=1): 1

================================================================================
ğŸ“„ Phase 3-1: ìŠ¤í¬ë¦½íŠ¸ íŒŒì‹±
================================================================================
âœ… 28ê°œ ì¥ë©´ íŒŒì‹± ì™„ë£Œ

================================================================================
ğŸ” Phase 3-0: ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
================================================================================
âœ… Visual Guidelines ìƒì„± ì™„ë£Œ
  Art Style: Flat vector illustration
  Primary Color: #6366f1
  Mood: Professional and engaging

âœ… Content Analysis ìƒì„± ì™„ë£Œ
  Duration: 6ë¶„ 50ì´ˆ
  Type: educational
  Topic: AIë¥¼ í™œìš©í•œ ìë™ íŒŸìºìŠ¤íŠ¸ ìƒì„± ê¸°ìˆ 
  Summary: ê¸´ ë¬¸ì„œë¥¼ AIê°€ ìë™ìœ¼ë¡œ íŒŸìºìŠ¤íŠ¸ë¡œ ë³€í™˜

================================================================================
ğŸ¬ Phase 3-1: ì´ë¯¸ì§€ ê³„íš ìƒì„±
================================================================================
âœ… 7ê°œ ì´ë¯¸ì§€ ê³„íš ìƒì„± ì™„ë£Œ

================================================================================
ğŸ“ Phase 3-2: í”„ë¡¬í”„íŠ¸ ìƒì„±
================================================================================
âœ… 7ê°œ í”„ë¡¬í”„íŠ¸ ìƒì„± ì™„ë£Œ

================================================================================
â° Phase 3-3: íƒ€ì„ìŠ¤íƒ¬í”„ ë§¤í•‘
================================================================================
âœ… 7ê°œ íƒ€ì„ë¼ì¸ í•­ëª© ìƒì„±

================================================================================
ğŸ‰ Phase 3 ì™„ë£Œ!
================================================================================
```

### **Phase 4 í…ŒìŠ¤íŠ¸**

```bash
python tests/test_image_generation.py
```

**ì˜ˆìƒ ì¶œë ¥:**
```
================================================================================
ğŸ¨ Phase 4: ì´ë¯¸ì§€ ìƒì„± (ë‚˜ë…¸ë°”ë‚˜ë‚˜)
================================================================================

ğŸ“‚ í”„ë¡¬í”„íŠ¸ ë¡œë“œ: outputs/image_prompts/image_prompts.json
âœ… 7ê°œ í”„ë¡¬í”„íŠ¸ ë¡œë“œ ì™„ë£Œ

================================================================================
ğŸ–¼ï¸  ì´ë¯¸ì§€ ìƒì„± ì‹œì‘
================================================================================

[1/7] img_001 - ì •ë³´ ê³¼ë¶€í•˜ì™€ ì½ê¸° í”¼ë¡œ
âœ… ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ: outputs/images/img_001.png

[2/7] img_002 - AI íŒŸìºìŠ¤íŠ¸ ìƒì„± ì†”ë£¨ì…˜
âœ… ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ: outputs/images/img_002.png

...

[7/7] img_007 - ë„ì „ ê³¼ì œì™€ ë¯¸ë˜ ë¹„ì „
âœ… ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ: outputs/images/img_007.png

================================================================================
ğŸ‰ ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ!
================================================================================

ğŸ“Š ê²°ê³¼:
  ìƒì„±ëœ ì´ë¯¸ì§€: 7ê°œ
  ì´ ë¹„ìš©: $0.273
  ì €ì¥ ìœ„ì¹˜: outputs/images/
```

---

## ğŸ¯ ì£¼ìš” ê°œì„ ì‚¬í•­

### **1. ìŠ¤íƒ€ì¼ í†µì¼ ì‹œìŠ¤í…œ**
- âœ… ëª¨ë“  ì´ë¯¸ì§€ì— ë™ì¼í•œ ì•„íŠ¸ ìŠ¤íƒ€ì¼ ì ìš©
- âœ… ìƒ‰ìƒ íŒ”ë ˆíŠ¸ í†µì¼
- âœ… ì¡°ëª…/êµ¬ë„ ê°€ì´ë“œë¼ì¸ í†µì¼

### **2. ë™ì  ì´ë¯¸ì§€ ê°œìˆ˜**
```python
# íŒŸìºìŠ¤íŠ¸ ê¸¸ì´ì— ë”°ë¼ ìë™ ê²°ì •
1-3ë¶„:   3-5ê°œ
3-5ë¶„:   5-7ê°œ
5-10ë¶„:  7-12ê°œ
10-20ë¶„: 12-18ê°œ
20ë¶„+:   18-25ê°œ
```

### **3. ë‚˜ë…¸ë°”ë‚˜ë‚˜ ìµœì í™”**
- âœ… í•œê¸€ ëŒ€í™”í˜• í”„ë¡¬í”„íŠ¸ ("~í•´ì£¼ì„¸ìš”")
- âœ… 200-300ì ìƒì„¸ í”„ë¡¬í”„íŠ¸
- âœ… **ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ëŠ” ì˜ì–´ë¡œë§Œ** (í•œê¸€ ê¹¨ì§ ë°©ì§€)
- âœ… 16:9 ë¹„ìœ¨ ëª…ì‹œ

### **4. ì¬ì‹œë„ ë¡œì§**
```python
for attempt in range(3):
    try:
        # Gemini í˜¸ì¶œ
        if attempt > 0:
            print(f"ì¬ì‹œë„ {attempt + 1}/3...")
        ...
        return result  # ì„±ê³µ!
    except Exception:
        if attempt < 2:
            continue  # ì¬ì‹œë„
        else:
            raise RuntimeError(...)  # ìµœì¢… ì‹¤íŒ¨
```

### **5. ë”ë¯¸ ë°ì´í„° ì œê±°**
- âŒ ì‹¤íŒ¨ ì‹œ ë”ë¯¸ ë°ì´í„° ë°˜í™˜ ì—†ìŒ
- âœ… ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ë°œìƒ
- âœ… ì‹¤ì œ ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ

### **6. DB ì €ì¥ìš© ë©”íƒ€ë°ì´í„°**
```json
{
  "content": {
    "main_topic": "AI ìë™ íŒŸìºìŠ¤íŠ¸ ìƒì„± ê¸°ìˆ ",
    "summary": "í•œ ì¤„ ìš”ì•½ (50-80ì)",
    "detailed_summary": "ìƒì„¸ ìš”ì•½ (3-10ë¬¸ì¥, ê¸¸ì´ì— ë”°ë¼)",
    ...
  }
}
```

---

## ğŸ“š API ë ˆí¼ëŸ°ìŠ¤

### **MetadataExtractionNode**

```python
from app.nodes.metadata_extraction_node import MetadataExtractionNode

node = MetadataExtractionNode(
    project_id="your-project-id",
    location="us-central1",
    model_name="gemini-2.5-flash"
)

metadata = node.extract_metadata(scenes)
# Returns: PodcastMetadata
```

**PodcastMetadata êµ¬ì¡°:**
```python
@dataclass
class PodcastMetadata:
    podcast_id: str
    created_at: str
    visual: GlobalVisualGuidelines
    content: ContentAnalysis
```

---

### **ImagePlanningNode**

```python
from app.nodes.image_planning_node import ImagePlanningNode

node = ImagePlanningNode(
    project_id="your-project-id",
    location="us-central1"
)

plans = node.create_image_plans(
    full_script="[00:00:00] Host A: ...",
    metadata=podcast_metadata
)
# Returns: List[ImagePlan] (3-25ê°œ)
```

---

### **PromptGenerationNode**

```python
from app.nodes.prompt_generation_node import PromptGenerationNode

node = PromptGenerationNode(
    project_id="your-project-id",
    location="us-central1"
)

prompts = node.generate_prompts_for_plans(
    plans=image_plans,
    metadata=podcast_metadata
)
# Returns: List[Dict] (í”„ë¡¬í”„íŠ¸)
```

---

### **ImageGenerationNode**

```python
from app.nodes.image_generation_node import ImageGenerationNode

node = ImageGenerationNode(
    project_id="your-project-id",
    location="us-central1"
)

node.generate_images_from_prompts(
    prompts=prompts,
    output_dir="outputs/images"
)
# ìƒì„±: img_001.png ~ img_007.png
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### **1. ì¸ì¦ ì˜¤ë¥˜**

**ì¦ìƒ:**
```
RuntimeError: Vertex AI ëª¨ë¸ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤
```

**í•´ê²°:**
```bash
# Service Account Key í™•ì¸
export GOOGLE_APPLICATION_CREDENTIALS="path/to/key.json"

# ë˜ëŠ” gcloud ë¡œê·¸ì¸
gcloud auth application-default login
```

---

### **2. JSON íŒŒì‹± ì—ëŸ¬**

**ì¦ìƒ:**
```
âš ï¸  JSON íŒŒì‹± ì‹¤íŒ¨ (ì‹œë„ 1/3): Unterminated string
   ì¬ì‹œë„ 2/3...
```

**í•´ê²°:**
- ìë™ ì¬ì‹œë„ 3íšŒ ì‹¤í–‰ ì¤‘
- ëŒ€ë¶€ë¶„ ì¬ì‹œë„ë¡œ í•´ê²°ë¨
- ì§€ì† ì‹œ: `max_output_tokens` ì¦ê°€ í•„ìš”

---

### **3. 429 ì—ëŸ¬ (Rate Limit)**

**ì¦ìƒ:**
```
âŒ 429 Resource exhausted: Quota exceeded
```

**í•´ê²°:**
- ì´ë¯¸ì§€ ìƒì„± ë…¸ë“œê°€ ìë™ìœ¼ë¡œ ì¬ì‹œë„ (ì§€ìˆ˜ ë°±ì˜¤í”„)
- í• ë‹¹ëŸ‰: ë¶„ë‹¹ 5ê°œ ì´ë¯¸ì§€
- 7ê°œ ì´ë¯¸ì§€ëŠ” ì•½ 2ë¶„ ì†Œìš”

---

### **4. í•œê¸€ í…ìŠ¤íŠ¸ ê¹¨ì§**

**ì¦ìƒ:**
- ë‹¤ì´ì–´ê·¸ë¨/ì°¨íŠ¸ì˜ í•œê¸€ ë¼ë²¨ì´ ê¹¨ì ¸ ë³´ì„

**í•´ê²°:**
- âœ… ì´ë¯¸ í•´ê²°ë¨! í”„ë¡¬í”„íŠ¸ì— "ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ëŠ” ì˜ì–´ë¡œ" ëª…ì‹œ
- ë‹¤ì´ì–´ê·¸ë¨ ì˜ˆ: "Text Input" â†’ "Processing" â†’ "Audio Output"

---

### **5. ìŠ¤íƒ€ì¼ í†µì¼ ì•ˆ ë¨**

**ì¦ìƒ:**
- ê° ì´ë¯¸ì§€ë§ˆë‹¤ ìŠ¤íƒ€ì¼ì´ ì œê°ê°

**í•´ê²°:**
- âœ… ì´ë¯¸ í•´ê²°ë¨! GlobalVisualGuidelines ì‚¬ìš©
- ëª¨ë“  í”„ë¡¬í”„íŠ¸ì— ë™ì¼ ìŠ¤íƒ€ì¼ ì ìš©

---

## ğŸ’° ë¹„ìš© ì •ë³´

### **Phase 3 (LLM í˜¸ì¶œ)**
- **Gemini 2.5 Flash**: $0.075 / 1M input tokens, $0.30 / 1M output tokens
- **ì˜ˆìƒ ë¹„ìš©**: 7ë¶„ íŒŸìºìŠ¤íŠ¸ ê¸°ì¤€ ì•½ $0.05

### **Phase 4 (ì´ë¯¸ì§€ ìƒì„±)**
- **Gemini 2.5 Flash Image (ë‚˜ë…¸ë°”ë‚˜ë‚˜)**: $0.039 / ì´ë¯¸ì§€
- **ì˜ˆìƒ ë¹„ìš©**: 7ê°œ ì´ë¯¸ì§€ ê¸°ì¤€ $0.273

### **ì´ ë¹„ìš©**
- 7ë¶„ íŒŸìºìŠ¤íŠ¸: ì•½ **$0.32**
- 20ë¶„ íŒŸìºìŠ¤íŠ¸: ì•½ **$0.80** (ì´ë¯¸ì§€ 18ê°œ ê¸°ì¤€)

---

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ

| ë‹¨ê³„ | ì†Œìš” ì‹œê°„ | ì¬ì‹œë„ìœ¨ | ì„±ê³µë¥  |
|------|----------|---------|--------|
| Phase 3-0 (ë©”íƒ€ë°ì´í„°) | 10-15ì´ˆ | 5% | 95% |
| Phase 3-1 (ì´ë¯¸ì§€ ê³„íš) | 8-12ì´ˆ | 5% | 95% |
| Phase 3-2 (í”„ë¡¬í”„íŠ¸) | 15-25ì´ˆ | 10% | 90% |
| Phase 4 (ì´ë¯¸ì§€ ìƒì„±) | 70-140ì´ˆ | 15% | 85% |
| **ì „ì²´ íŒŒì´í”„ë¼ì¸** | **2-3ë¶„** | - | **85%+** |

---

## ğŸ“ Best Practices

### **1. ì…ë ¥ ìŠ¤í¬ë¦½íŠ¸**
- âœ… íƒ€ì„ìŠ¤íƒ¬í”„ í•„ìˆ˜: `[HH:MM:SS]` í˜•ì‹
- âœ… í™”ì ëª…ì‹œ: `Host A:`, `Guest B:`
- âœ… ìµœì†Œ ê¸¸ì´: 3ë¶„ ì´ìƒ ê¶Œì¥

### **2. ì—ëŸ¬ ì²˜ë¦¬**
- âœ… ì¬ì‹œë„ ë¡œì§ í™œìš© (ìë™)
- âœ… ë¡œê·¸ í™•ì¸ í›„ ë¬¸ì œ íŒŒì•…
- âœ… ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

### **3. ë¹„ìš© ìµœì í™”**
- âœ… í…ŒìŠ¤íŠ¸ ì‹œ ì§§ì€ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
- âœ… í”„ë¡¬í”„íŠ¸ ìºì‹± ê³ ë ¤ (í–¥í›„)
- âœ… ë°°ì¹˜ ì²˜ë¦¬ ê³ ë ¤ (ëŒ€ëŸ‰ ìƒì„± ì‹œ)

### **4. í’ˆì§ˆ ê´€ë¦¬**
- âœ… ìƒì„±ëœ ì´ë¯¸ì§€ í™•ì¸
- âœ… ìŠ¤íƒ€ì¼ í†µì¼ ê²€ì¦
- âœ… íƒ€ì„ë¼ì¸ ì •í™•ë„ í™•ì¸

---

## ğŸ“ ì§€ì›

### **ë¬¸ì œ ë°œìƒ ì‹œ**
1. ë¡œê·¸ í™•ì¸
2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
3. Google Cloud í• ë‹¹ëŸ‰ í™•ì¸
4. íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì„¹ì…˜ ì°¸ì¡°

### **ì¶”ê°€ ê°œë°œ**
- Phase 5: ë¹„ë””ì˜¤ í•©ì„± (ì¶”í›„ ê°œë°œ)
- í”„ë¡¬í”„íŠ¸ ìºì‹± ìµœì í™”
- ë°°ì¹˜ ì²˜ë¦¬ ì‹œìŠ¤í…œ

---

## ğŸ“ ë³€ê²½ ì´ë ¥

### **v1.0.0** (2024-12-04)
- âœ… Phase 3-4 ì™„ì„±
- âœ… ë™ì  ì´ë¯¸ì§€ ê°œìˆ˜
- âœ… ìŠ¤íƒ€ì¼ í†µì¼ ì‹œìŠ¤í…œ
- âœ… ë‚˜ë…¸ë°”ë‚˜ë‚˜ ìµœì í™”
- âœ… ì¬ì‹œë„ ë¡œì§
- âœ… ë”ë¯¸ ë°ì´í„° ì œê±°
- âœ… ì´ë¯¸ì§€ ë‚´ í…ìŠ¤íŠ¸ ì˜ì–´í™”
- âœ… DB ì €ì¥ìš© ë©”íƒ€ë°ì´í„° (ì£¼ì œ, ìš”ì•½)

---

## ğŸ‰ ë§ˆë¬´ë¦¬

ì´ì œ ì™„ì „í•œ ì´ë¯¸ì§€ ìƒì„± íŒŒì´í”„ë¼ì¸ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!

**ë‹¤ìŒ ë‹¨ê³„:**
1. íŒŒì¼ ë³µì‚¬ â†’ í”„ë¡œì íŠ¸ í†µí•©
2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ ê²°ê³¼ í™•ì¸
3. ì‹¤ì œ ì„œë¹„ìŠ¤ ì ìš©

**í•µì‹¬ ì¥ì :**
- âœ… ì™„ì „ ìë™í™”
- âœ… ë†’ì€ í’ˆì§ˆ
- âœ… ìŠ¤íƒ€ì¼ í†µì¼
- âœ… ì‹¤ì œ ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ

---

**Happy Coding! ğŸš€**